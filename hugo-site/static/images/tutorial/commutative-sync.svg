<svg viewBox="0 0 520 300" xmlns="http://www.w3.org/2000/svg" font-family="system-ui, -apple-system, sans-serif">
  <style>
    :root {
      --box-bg: #f5f0e6;
      --box-border: #c4b89a;
      --box-final-bg: #c8dcc8;
      --box-final-border: #a8c0a8;
      --text-primary: #3a3a3a;
      --text-secondary: #666666;
      --text-label: #888888;
      --line-color: #a0a0a0;
      --sync-color: #7a9f7a;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --box-bg: #3d3830;
        --box-border: #5a5040;
        --box-final-bg: #3a4a3a;
        --box-final-border: #506050;
        --text-primary: #e8e8e8;
        --text-secondary: #b0b0b0;
        --text-label: #909090;
        --line-color: rgba(255,255,255,0.5);
        --sync-color: #6a8f6a;
      }
    }
    .box { fill: var(--box-bg); stroke: var(--box-border); stroke-width: 1.5; }
    .box-final { fill: var(--box-final-bg); stroke: var(--box-final-border); stroke-width: 1.5; }
    .text-primary { fill: var(--text-primary); }
    .text-secondary { fill: var(--text-secondary); }
    .text-label { fill: var(--text-label); }
    .line { stroke: var(--line-color); stroke-width: 1.5; fill: none; }
    .line-sync { stroke: var(--sync-color); stroke-width: 1.5; fill: none; stroke-dasharray: 4 3; }
    .arrow { fill: var(--line-color); }
    .arrow-sync { fill: var(--sync-color); }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" class="arrow" />
    </marker>
  </defs>

  <!-- Peer labels -->
  <text x="130" y="20" font-size="12" font-weight="500" text-anchor="middle" class="text-secondary">Peer A</text>
  <text x="390" y="20" font-size="12" font-weight="500" text-anchor="middle" class="text-secondary">Peer B</text>

  <!-- Initial state boxes -->
  <rect x="60" y="30" width="140" height="32" rx="6" class="box"/>
  <text x="130" y="51" font-size="11" text-anchor="middle" class="text-primary">State: [ ]</text>

  <rect x="320" y="30" width="140" height="32" rx="6" class="box"/>
  <text x="390" y="51" font-size="11" text-anchor="middle" class="text-primary">State: [ ]</text>

  <!-- Arrows down -->
  <line x1="130" y1="62" x2="130" y2="82" class="line" marker-end="url(#arrowhead)"/>
  <line x1="390" y1="62" x2="390" y2="82" class="line" marker-end="url(#arrowhead)"/>

  <!-- Action labels -->
  <text x="130" y="100" font-size="10" font-style="italic" text-anchor="middle" class="text-label">Add "Hello"</text>
  <text x="390" y="100" font-size="10" font-style="italic" text-anchor="middle" class="text-label">Add "World"</text>

  <!-- Arrows down -->
  <line x1="130" y1="108" x2="130" y2="128" class="line" marker-end="url(#arrowhead)"/>
  <line x1="390" y1="108" x2="390" y2="128" class="line" marker-end="url(#arrowhead)"/>

  <!-- Intermediate state boxes -->
  <rect x="50" y="135" width="160" height="32" rx="6" class="box"/>
  <text x="130" y="156" font-size="11" text-anchor="middle" class="text-primary">State: [Hello]</text>

  <rect x="310" y="135" width="160" height="32" rx="6" class="box"/>
  <text x="390" y="156" font-size="11" text-anchor="middle" class="text-primary">State: [World]</text>

  <!-- Sync line -->
  <line x1="180" y1="182" x2="340" y2="182" class="line-sync"/>
  <text x="260" y="178" font-size="9" font-style="italic" text-anchor="middle" class="text-label">sync</text>

  <!-- Arrows down to sync -->
  <line x1="130" y1="167" x2="130" y2="195" class="line" marker-end="url(#arrowhead)"/>
  <line x1="390" y1="167" x2="390" y2="195" class="line" marker-end="url(#arrowhead)"/>

  <!-- Merge lines -->
  <line x1="130" y1="208" x2="190" y2="235" class="line-sync"/>
  <line x1="390" y1="208" x2="330" y2="235" class="line-sync"/>

  <!-- Final state boxes -->
  <rect x="30" y="242" width="200" height="36" rx="6" class="box-final"/>
  <text x="130" y="266" font-size="11" text-anchor="middle" class="text-primary">State: [Hello, World]</text>

  <rect x="290" y="242" width="200" height="36" rx="6" class="box-final"/>
  <text x="390" y="266" font-size="11" text-anchor="middle" class="text-primary">State: [Hello, World]</text>

  <!-- Equal sign -->
  <text x="260" y="266" font-size="14" font-weight="500" text-anchor="middle" class="text-secondary">=</text>
</svg>
